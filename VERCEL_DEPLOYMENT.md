# Развертывание на Vercel

Этот проект настроен для развертывания на Vercel как full-stack приложение.

## Подготовка к развертыванию

### 1. Настройка базы данных
Создайте PostgreSQL базу данных на одном из сервисов:
- [Neon](https://neon.tech/) (рекомендуется)
- [Supabase](https://supabase.com/)
- [PlanetScale](https://planetscale.com/)

### 2. Переменные окружения
Скопируйте `.env.example` в `.env` и заполните:
```bash
cp .env.example .env
```

## Способы развертывания

### Вариант 1: Через Vercel CLI (рекомендуется)

1. Установите Vercel CLI:
```bash
npm i -g vercel
```

2. Войдите в аккаунт:
```bash
vercel login
```

3. Разверните проект:
```bash
vercel --prod
```

4. Добавьте переменные окружения через веб-интерфейс Vercel или CLI:
```bash
vercel env add DATABASE_URL
vercel env add SESSION_SECRET
```

### Вариант 2: Через GitHub

1. Загрузите код в GitHub репозиторий
2. Зайдите на [vercel.com](https://vercel.com)
3. Подключите GitHub репозиторий
4. Добавьте переменные окружения в настройках проекта
5. Vercel автоматически развернет проект

## Настройка переменных окружения в Vercel

В панели управления Vercel добавьте следующие переменные:

- `DATABASE_URL` - строка подключения к PostgreSQL
- `SESSION_SECRET` - секретный ключ для сессий (сгенерируйте случайную строку)
- `NODE_ENV` - установите в `production`

## Структура проекта для Vercel

- `vercel.json` - конфигурация Vercel
- `api/index.ts` - serverless функция для API
- `dist/public/` - статические файлы фронтенда
- `server/` - код бэкенда

## Особенности развертывания

1. **Serverless функции**: Бэкенд работает как serverless функции
2. **Статические файлы**: Фронтенд обслуживается как статические файлы
3. **База данных**: Используйте connection pooling для PostgreSQL
4. **Сессии**: Рекомендуется использовать внешнее хранилище сессий

## Проверка развертывания

После развертывания:
1. Проверьте, что статические файлы загружаются
2. Протестируйте API endpoints
3. Убедитесь, что база данных подключена

## Возможные проблемы

- **WebSocket**: Vercel имеет ограничения на WebSocket соединения
- **Файловая система**: Serverless функции имеют read-only FS
- **Cold starts**: Первые запросы могут быть медленными

## Локальная разработка

```bash
npm run dev
```

## Сборка для продакшена

```bash
npm run build
```
